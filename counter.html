<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Countdown</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Zalando+Sans+Expanded:ital,wght@0,200..900;1,200..900&display=swap"
        rel="stylesheet">
    <!-- Animated Theme CSS -->
    <link rel="stylesheet" href="CSS/style-main.css" id="style-main-animated">
    <link rel="stylesheet" href="CSS/buttons.css" id="buttons-animated">
    <!-- Static Theme CSS -->
    <link rel="stylesheet" href="CSS/static/style-main-static.css" id="style-main-static" disabled>
    <link rel="stylesheet" href="CSS/static/buttons-static.css" id="buttons-static" disabled>
    <!-- Flow Theme CSS -->
    <link rel="stylesheet" href="CSS/flow/style-main-flow.css" id="style-main-flow" disabled>
    <link rel="stylesheet" href="CSS/flow/buttons-flow.css" id="buttons-flow" disabled>
    <link rel="stylesheet" href="CSS/flow/flow-bg.css" id="flow-bg-css" disabled>
    <link rel="stylesheet" href="CSS/puzzle-theme.css">
</head>

<body>

    <section id="day-form">
        <h2>Countdown</h2>
        <p>Widget to count down the time until class ends</p>
        <label for="dayinput">Enter Day</label>
        <input type="text" id="dayinput" placeholder="e.g., monday">

        <label for="periodinput">Enter Period</label>
        <input type="text" id="periodinput" placeholder="e.g., 1">

        <button id="start">Submit</button>
        <label for="countdown">Time Remaining:</label>
        <input type="text" id="countdown" readonly>
        <br>
        <button id="main">Return To Homepage</button>
    </section>

    <div id="live-wallpaper">
        <video autoplay muted loop preload="auto" id="bg-video">
            <source src="videos/wallpaper.mp4" type="video/mp4">
        </video>
    </div>

    <canvas id="flow-bg" style="display: none;"></canvas>

    <script src="Javascript/counter-main.js"></script>
    <script src="Javascript/Javascript-linking/counter_link.js"></script>
    <script>
        const savedTheme = localStorage.getItem('theme') || 'animated';
        const flowBgCss = document.getElementById('flow-bg-css');
        const flowCanvas = document.getElementById('flow-bg');

        if (savedTheme === 'static') {
            document.getElementById('style-main-animated').disabled = true;
            document.getElementById('buttons-animated').disabled = true;
            document.getElementById('style-main-static').disabled = false;
            document.getElementById('buttons-static').disabled = false;
            document.getElementById('style-main-flow').disabled = true;
            document.getElementById('buttons-flow').disabled = true;
            if (flowBgCss) flowBgCss.disabled = true;
            if (flowCanvas) flowCanvas.style.display = 'none';
        } else if (savedTheme === 'flow') {
            document.getElementById('style-main-animated').disabled = true;
            document.getElementById('buttons-animated').disabled = true;
            document.getElementById('style-main-static').disabled = true;
            document.getElementById('buttons-static').disabled = true;
            document.getElementById('style-main-flow').disabled = false;
            document.getElementById('buttons-flow').disabled = false;
            if (flowBgCss) flowBgCss.disabled = false;
            if (flowCanvas) flowCanvas.style.display = 'block';
        } else {
            if (flowBgCss) flowBgCss.disabled = true;
            if (flowCanvas) flowCanvas.style.display = 'none';
        }

        const canvas = document.getElementById('flow-bg');
        if (canvas) {
            const ctx = canvas.getContext('2d');
            let canvasWidth, canvasHeight;
            let flowingLines = [];
            let isInitialized = false;

            function initializeCanvas() {
                canvasWidth = window.innerWidth;
                canvasHeight = Math.max(document.documentElement.scrollHeight, window.innerHeight);
                canvas.width = canvasWidth;
                canvas.height = canvasHeight;
                flowingLines = [];
                const screenDiagonal = Math.sqrt(canvasWidth * canvasWidth + canvasHeight * canvasHeight);
                const maxDistanceFromCenter = screenDiagonal / 2;
                for (let i = 0; i < 5000; i++) {
                    const randomValue = Math.random();
                    const pushTowardsEdge = Math.pow(randomValue, 0.4);
                    const distanceFromCenter = pushTowardsEdge * maxDistanceFromCenter;
                    const startingAngle = Math.random() * 6.28;
                    const rotationSpeed = 0.001 + Math.random() * 0.003;
                    const opacity = 0.2 + Math.random() * 0.3;
                    flowingLines.push({ angle: startingAngle, radius: distanceFromCenter, speed: rotationSpeed, opacity: opacity });
                }
                ctx.fillStyle = 'black';
                ctx.fillRect(0, 0, canvasWidth, canvasHeight);
                isInitialized = true;
            }

            window.addEventListener('resize', function () {
                if (canvas.style.display !== 'none') initializeCanvas();
            });

            function animateLines() {
                if (!isInitialized || canvas.style.display === 'none') {
                    requestAnimationFrame(animateLines);
                    return;
                }
                ctx.fillStyle = 'rgba(0,0,0,0.08)';
                ctx.fillRect(0, 0, canvasWidth, canvasHeight);
                const centerX = canvasWidth / 2;
                const centerY = canvasHeight / 2;
                for (let i = 0; i < flowingLines.length; i++) {
                    const line = flowingLines[i];
                    line.angle = line.angle + line.speed;
                    const lineX = centerX + Math.cos(line.angle) * line.radius;
                    const lineY = centerY + Math.sin(line.angle) * line.radius;
                    const lineDirection = line.angle + 1.57;
                    const lineLength = 21;
                    const endX = lineX + Math.cos(lineDirection) * lineLength;
                    const endY = lineY + Math.sin(lineDirection) * lineLength;
                    ctx.strokeStyle = 'rgba(255,255,255,' + line.opacity + ')';
                    ctx.lineWidth = 0.8;
                    ctx.beginPath();
                    ctx.moveTo(lineX, lineY);
                    ctx.lineTo(endX, endY);
                    ctx.stroke();
                }
                requestAnimationFrame(animateLines);
            }

            if (savedTheme === 'flow') initializeCanvas();
            animateLines();
        }
    </script>

</body>